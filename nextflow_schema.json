{
    "$schema": "http://json-schema.org/draft-07/schema",
    "$id": "https://raw.githubusercontent.com/./master/nextflow_schema.json",
    "title": "GPS Pipeline Parameters",
    "description": "",
    "type": "object",
    "definitions": {
        "input_output_options": {
            "title": "Input / Output Options",
            "type": "object",
            "description": "",
            "default": "",
            "properties": {
                "reads": {
                    "type": "string",
                    "description": "Path to the input directory that contains the reads to be processed.",
                    "format": "directory-path"
                },
                "output": {
                    "type": "string",
                    "description": "Path to the output directory that save the results.",
                    "format": "directory-path"
                },
                "db": {
                    "type": "string",
                    "description": "Path to the directory saving databases used by the pipeline",
                    "format": "directory-path"
                },
                "singularity_cachedir": {
                    "type": "string",
                    "description": "(Only required when Singularity is used) Path to the directory where Singularity images should be saved to.",
                    "format": "directory-path"
                },
                "file_publish": {
                    "type": "string",
                    "description": "Method used by Nextflow to publish the generated assemblies and annotations (if selected).",
                    "hidden": true,
                    "enum": [
                        "link",
                        "symlink",
                        "copy"
                    ]
                }
            },
            "required": [
                "reads",
                "output",
                "db",
                "file_publish"
            ]
        },
        "qc_parameters": {
            "title": "QC Parameters",
            "type": "object",
            "description": "",
            "default": "",
            "properties": {
                "spneumo_percentage": {
                    "type": "number",
                    "description": "Minimum S. pneumoniae percentage in reads to pass Taxonomy QC.",
                    "hidden": true,
                    "minimum": 0,
                    "maximum": 100
                },
                "non_strep_percentage": {
                    "type": "number",
                    "hidden": true,
                    "description": "Maximum non-Streptococcus genus percentage in reads to pass Taxonomy QC.",
                    "minimum": 0,
                    "maximum": 100
                },
                "ref_coverage": {
                    "type": "number",
                    "description": "Minimum reference coverage percentage by the reads to pass Mapping QC.",
                    "hidden": true,
                    "minimum": 0,
                    "maximum": 100
                },
                "het_snp_site": {
                    "type": "integer",
                    "description": "Maximum non-cluster heterozygous SNP (Het-SNP) site count to pass Mapping QC.",
                    "hidden": true,
                    "minimum": 0
                },
                "contigs": {
                    "type": "integer",
                    "hidden": true,
                    "description": "Maximum contig count in assembly to pass Assembly QC.",
                    "minimum": 0
                },
                "length_low": {
                    "type": "integer",
                    "hidden": true,
                    "description": "Minimum assembly length to pass Assembly QC.",
                    "minimum": 0
                },
                "length_high": {
                    "type": "integer",
                    "hidden": true,
                    "description": "Maximum assembly length to pass Assembly QC.",
                    "minimum": 0
                },
                "depth": {
                    "type": "number",
                    "hidden": true,
                    "description": "Minimum sequencing depth to pass Assembly QC.",
                    "minimum": 0
                }
            },
            "required": [
                "spneumo_percentage",
                "non_strep_percentage",
                "ref_coverage",
                "het_snp_site",
                "contigs",
                "length_low",
                "length_high",
                "depth"
            ]
        },
        "assembly_options": {
            "title": "Assembly Options",
            "type": "object",
            "description": "",
            "default": "",
            "properties": {
                "assembler": {
                    "type": "string",
                    "hidden": true,
                    "description": "Using which SPAdes-based assembler to assemble the reads.",
                    "enum": [
                        "shovill",
                        "unicycler"
                    ]
                },
                "assembler_thread": {
                    "type": "integer",
                    "description": "Number of threads used by the assembler. 0 means all available.",
                    "hidden": true
                },
                "min_contig_length": {
                    "type": "integer",
                    "description": "Minimum legnth of contig to be included in the assembly.",
                    "hidden": true,
                    "minimum": 0
                }
            },
            "required": [
                "assembler",
                "assembler_thread",
                "min_contig_length"
            ]
        },
        "mapping_options": {
            "title": "Mapping Options",
            "type": "object",
            "description": "",
            "default": "",
            "properties": {
                "ref_genome": {
                    "type": "string",
                    "hidden": true,
                    "description": "Path to the reference genome for mapping.",
                    "pattern": ".+\\.(fa|fasta)$",
                    "format": "file-path",
                    "mimetype": "text/x-fasta"
                }
            },
            "required": [
                "ref_genome"
            ]
        },
        "taxonomy_options": {
            "title": "Taxonomy Options",
            "type": "object",
            "description": "",
            "default": "",
            "properties": {
                "kraken2_db_remote": {
                    "type": "string",
                    "hidden": true,
                    "description": "URL to a Kraken2 database.",
                    "pattern": "^(https?:\\/\\/)?(?:www\\.)?[-a-zA-Z0-9@:%._\\+~#=]{1,256}\\.[a-zA-Z0-9()]{1,6}\\b(?:[-a-zA-Z0-9()@:%_\\+.~#?&\\/=]*)\\.(tar\\.gz|tgz)$"
                },
                "kraken2_memory_mapping": {
                    "type": "boolean",
                    "hidden": true,
                    "description": "Using the memory mapping option of Kraken2 or not."
                }
            },
            "required": [
                "kraken2_db_remote",
                "kraken2_memory_mapping"
            ]
        },
        "serotype_options": {
            "title": "Serotype Options",
            "type": "object",
            "description": "",
            "default": "",
            "properties": {
                "seroba_db_remote": {
                    "type": "string",
                    "hidden": true,
                    "description": "URL to a SeroBA release.",
                    "pattern": "^(https?:\\/\\/)?(?:www\\.)?[-a-zA-Z0-9@:%._\\+~#=]{1,256}\\.[a-zA-Z0-9()]{1,6}\\b(?:[-a-zA-Z0-9()@:%_\\+.~#?&\\/=]*)\\.(tar\\.gz|tgz)$"
                },
                "seroba_kmer": {
                    "type": "integer",
                    "hidden": true,
                    "description": "Kmer size for creating the KMC database of SeroBA.",
                    "minimum": 0
                }
            },
            "required": [
                "seroba_db_remote",
                "seroba_kmer"
            ]
        },
        "lineage_options": {
            "title": "Lineage Options",
            "type": "object",
            "description": "",
            "default": "",
            "properties": {
                "poppunk_db_remote": {
                    "type": "string",
                    "hidden": true,
                    "description": "URL to a PopPUNK database.",
                    "pattern": "^(https?:\\/\\/)?(?:www\\.)?[-a-zA-Z0-9@:%._\\+~#=]{1,256}\\.[a-zA-Z0-9()]{1,6}\\b(?:[-a-zA-Z0-9()@:%_\\+.~#?&\\/=]*)\\.(tar\\.gz|tgz)$"
                },
                "poppunk_ext_remote": {
                    "type": "string",
                    "hidden": true,
                    "description": "URL to a PopPUNK external clusters file.",
                    "pattern": "^(https?:\\/\\/)?(?:www\\.)?[-a-zA-Z0-9@:%._\\+~#=]{1,256}\\.[a-zA-Z0-9()]{1,6}\\b(?:[-a-zA-Z0-9()@:%_\\+.~#?&\\/=]*)\\.csv$"
                }
            },
            "required": [
                "poppunk_db_remote",
                "poppunk_ext_remote"
            ]
        },
        "annotation_options": {
            "type": "boolean",
            "hidden": true,
            "description": "Enable optional annotation module",
            "title": "Annotation Options",
            "default": false,
            "properties": {
                "bakta_db_remote": {
                    "type": "string",
                    "hidden": true,
                    "description": "URL to a Bakta database.",
                    "pattern": "^(https?:\\/\\/)?(?:www\\.)?[-a-zA-Z0-9@:%._\\+~#=]{1,256}\\.[a-zA-Z0-9()]{1,6}\\b(?:[-a-zA-Z0-9()@:%_\\+.~#?&\\/=]*)\\.(tar.xz)$"
                }
            }
        },
        "other_amr_options": {
            "title": "Other AMR Options",
            "type": "object",
            "description": "",
            "default": "",
            "properties": {
                "ariba_ref": {
                    "type": "string",
                    "hidden": true,
                    "description": "Path to the reference sequences for ARIBA.",
                    "pattern": ".+\\.(fa|fasta)$",
                    "format": "file-path",
                    "mimetype": "text/x-fasta"
                },
                "ariba_metadata": {
                    "type": "string",
                    "hidden": true,
                    "description": "Path to the metadata file for ARIBA.",
                    "pattern": "/.+\\.tsv$",
                    "format": "file-path",
                    "mimetype": "text/tab-separated-values"
                },
                "resistance_to_mic": {
                    "type": "string",
                    "hidden": true,
                    "description": "Path to the resistance phenotypes to MIC (minimum inhibitory concentration) lookup table.",
                    "pattern": "/.+\\.tsv$",
                    "format": "file-path",
                    "mimetype": "text/tab-separated-values"
                }
            },
            "required": [
                "ariba_ref",
                "ariba_metadata",
                "resistance_to_mic"
            ]
        },
        "workflow_selection": {
            "title": "Workflow Selection",
            "type": "object",
            "description": "Workflow and optional module selection",
            "default": "",
            "properties": {
                "help": {
                    "type": "boolean",
                    "description": "Alternative workflow for help message",
                    "hidden": true
                },
                "init": {
                    "type": "boolean",
                    "description": "Alternative workflow for initialisation only",
                    "hidden": true
                },
                "version": {
                    "type": "boolean",
                    "description": "Alternative workflow for getting versions of pipeline and tools",
                    "hidden": true
                },
                "annotation": {
                    "type": "boolean",
                    "hidden": true,
                    "description": "Enable optional annotation module"
                },
                "lite": {
                    "type": "boolean",
                    "description": "Enable experimental storage reduction (break the -resume function of Nextflow)",
                    "hidden": true
                }
            },
            "required": [
                "help",
                "init",
                "version",
                "annotation",
                "lite"
            ]
        }
    },
    "allOf": [
        {
            "$ref": "#/definitions/input_output_options"
        },
        {
            "$ref": "#/definitions/qc_parameters"
        },
        {
            "$ref": "#/definitions/assembly_options"
        },
        {
            "$ref": "#/definitions/mapping_options"
        },
        {
            "$ref": "#/definitions/taxonomy_options"
        },
        {
            "$ref": "#/definitions/serotype_options"
        },
        {
            "$ref": "#/definitions/lineage_options"
        },
        {
            "$ref": "#/definitions/annotation_options"
        },
        {
            "$ref": "#/definitions/other_amr_options"
        },
        {
            "$ref": "#/definitions/workflow_selection"
        }
    ]
}